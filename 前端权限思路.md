- 权限分类：

前端权限和后端权限：

前端：前端权限控制不了数据库，只控制视图层展示

后端：依然是权限控制的关键，控制用户是否能对数据进行增删改查的操作。

在前后端分离的架构中一般采用 token 来做状态保持，token 就是一串字符串。

- 前端权限的意义
- 前端权限的控制思路

1. 菜单  后台管理系统的侧边栏 登录请求会获取权限数据，根据权限会动态生成有哪些菜单
2. 界面  用户没有登录必须强制跳转到登陆界面；已登录但手动输入非权限地址则会报 404
3. 按钮  根据权限数据展示可以进行操作的按钮
4. 请求  非常规操作的请求应该被前端拦截，比如将禁用按钮变成启用按钮

关于菜单：

将 vuex 中的 state 映射成 home.vue 中的计算属性，home 中通过 mapState 进行映射

有一个 bug：登录后刷新页面，vuex 中的数据重新加载，所以需要 sessionStorage 存储

退出登录后应该将 sessionStorage 和 Vuex 中的数据都清空

关于界面：

1：未登录强制跳转到登录界面，使用路由导航守卫，当路由发生变化时对用户是否登录进行条件判断

2：登陆后的用户，防止跳转到他没有备权限的页面，需要动态路由。根据当前用户的权限数据判断要添加哪些路由规则。而不是把所有路由规则都写出来。

![img](C:\Users\Administrator\AppData\Local\YNote\data\weixinobU7VjquQjm7bGC68b8yc7E5HnIE\b82f3918303845e7b04cb0cf0a2be172\1614238262(1).png)

![img](C:\Users\Administrator\AppData\Local\YNote\data\weixinobU7VjquQjm7bGC68b8yc7E5HnIE\837b0b2a125c436fbf3b6cb037de50e1\1614238634(1).png)

bug：用户所具备的二级权限页面在刷新后竟然不存在了

刷新后路由文件会重新加载，动态路由不复存在

关于按钮：

用户没有使用增删改查按钮操作的权限，就不应该让这些按钮显示出来；

通过自定义指令的内部觉得按钮是否显示出来。

关于请求：

显示用户列表：需要 token ,在除了登录请求外的所有请求头中加入 token；

阻止非权限请求： 比如在审查元素中去掉按钮的禁用样式，按钮就可以用了，所以阻止这种行为。

通过请求方式和权限的映射关系，得到当前的请求时哪种操作，判断当前路由规则中存不存在这种操作，不存在就 return,这个请求就不会到服务器中。

关于响应：token 被篡改或超时，返回 401，页面数据不加载，强制转到登录界面。